<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>widget_test</title>
    <script src="libs/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="libs/jquery-ui-1.7.2.custom.min" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" charset="utf-8">
 
 
 
 
 var Green5 = {
    getLevel: function() {
        return this._getData('level');
    },
    setLevel: function(x) {
        var greenlevels = this._getData('greenlevels');
        var level = Math.floor(Math.min(greenlevels.length - 1, Math.max(0, x)));
        this._setData('level', level);
        this.element.css({
            background: greenlevels[level]
        });
        this._trigger('change', 0, level);
    },
    _init: function() {
        this.setLevel(this.getLevel());
    },
    // grab the default value and use it
    darker: function() {
        this.setLevel(this.getLevel() - 1);
    },
    lighter: function() {
        this.setLevel(this.getLevel() + 1);
    },
    off: function() {
        this.element.css({
            background: 'none'
        });
        this._trigger('done');
        this.destroy();
        // use the predefined function
    }
};
$.widget("ui.green5", Green5);
$.ui.green5.getter = "getLevel";
$.ui.green5.defaults = {
    level: 15,
    greenlevels: ['#000', '#010', '#020', '#030', '#040', '#050', '#060', '#070', '#080', '#090', '#0a0', '#0b0', '#0c0', '#0d0', '#0e0', '#0f0', '#fff']
};

    
      Green6 = $.extend({}, $.ui.green5.prototype, $.ui.mouse,{ // leave the old Green5 alone; create a new object
      	_init: function(){
      		$.ui.green5.prototype._init.call(this); // call the original function
      		this._mouseInit(); // start up the mouse handling
      	},
      	destroy: function(){
      		this._mouseDestroy();
      		$.ui.green5.prototype.destroy.call(this); // call the original function
      	},
      	// need to override the mouse functions
      	_mouseStart: function(e){
      		// keep track of where the mouse started
      		this._setData('xStart', e.pageX);
      		this._setData('levelStart', this._getData('level'));
      	},
      	_mouseDrag: function(e){
      		this.setLevel(this._getData('levelStart') +(e.pageX-this._getData('xStart'))/this._getData('distance'));
      	}
      });
      $.widget("ui.green7", Green6);
      $.ui.green7.defaults = $.extend({}, $.ui.mouse.defaults, {
      	level: 15,
      	greenlevels: ['#000','#010','#020','#030','#040','#050','#060','#070','#080','#090','#0a0','#0b0','#0c0','#0d0','#0e0','#0f0', '#fff'],
      	distance: 10
      }); 
      
    </script>
  </head>
  <body id="widget_test" onload="">

    <div id="test6">

    	<p class="target">This is a test paragraph with green level <span class="level">undefined</span>.</p>     	    	      
    	<input type="button" value="on"/>
    	<input type="button" value="darker"/>

    	<input type="button" value="lighter"/>
    	<input type="button" value="off"/>
    </div>
    <script>
    $('#test6 input[value=on]').click(function() {
    	$(this).prevAll('.target').green7({
    		change: function(evt, x){
    			$('.level', this).text(x);
    		},
    		done: function(){
    			$('.level', this).text('undefined');
    		}
    	});
    });
    $('#test6 input[value=darker]').click(function() {$(this).prevAll('.target').green7('darker')});
    $('#test6 input[value=lighter]').click(function() {$(this).prevAll('.target').green7('lighter')});
    $('#test6 input[value=off]').click(function() {$(this).prevAll('.target').green7('off')});
    </script>


    
  </body>
</html>


